model:

  pokingrecon:
    nobjs: 1
    vi_shift: 2
    
    mdepth_loss_on: False
    smooth_loss_on: True
    smooth_loss1_on: False
    smooth_loss2_on: True
    smooth_loss_weight: 0.005
    recon_volume_size: 1.0
    rand_method: 'samask_inv0_random'
    
    frame_ids: [ 57,58,59,60,64,65,66,67,68,69,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,102,103,104,105,106,107,108,109 ]
    fix_objpose_optim_frame_ids: [ ]
    fix_objpose_optim_frame_ids_all_objs: [ [ 57,58,59,60,64,65,66,67,68,69,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,102,103,104,105,106,107,108,109 ] ]
    pose_init: [
      [ [ -0.5159, -0.2502,  0.0625, -0.0000,  0.0000,  0.2000 ],
        [ -0.4042, -0.3501,  0.0636,  0.0090, -0.0002, -0.0906 ],
        [ -0.2757, -0.4384,  0.0641,  0.0141, -0.0034, -0.4224 ],
        [ -0.0662, -0.5214,  0.0649,  0.0164, -0.0092, -1.0096 ],
        [ -0.0656, -0.5210,  0.0648,  0.0152, -0.0113, -1.0120 ],
        [ 0.0354, -0.5599,  0.0668,  0.0191, -0.0070, -1.3053 ],
        [ 0.1519, -0.5771,  0.0686,  0.0238, -0.0039, -1.6384 ],
        [ 0.2111, -0.5780,  0.0707,  0.0311, -0.0011, -1.8054 ],
        [ 0.2519, -0.5785,  0.0733,  0.0399,  0.0017, -1.9121 ],
        [ 0.2575, -0.5774,  0.0741,  0.0410,  0.0007, -1.9257 ],
        [ 0.2515, -0.5810,  0.0676,  0.0106, -0.0101, -1.9184 ],
        [ 0.2540, -0.5717,  0.0666,  0.0102, -0.0110, -1.9336 ],
        [ 0.2631, -0.5462,  0.0684,  0.0147, -0.0083, -1.9817 ],
        [ 0.2719, -0.5225,  0.0680,  0.0150, -0.0096, -2.0267 ],
        [ 0.2771, -0.5064,  0.0680,  0.0164, -0.0090, -2.0560 ],
        [ 0.2891, -0.4732,  0.0681,  0.0166, -0.0103, -2.1246 ],
        [ 0.3027, -0.4426,  0.0677,  0.0166, -0.0105, -2.1923 ],
        [ 0.3110, -0.4235,  0.0678,  0.0167, -0.0104, -2.2347 ],
        [ 0.3297, -0.3868,  0.0665,  0.0162, -0.0153, -2.3281 ],
        [ 0.3381, -0.3725,  0.0665,  0.0154, -0.0156, -2.3683 ],
        [ 0.3652, -0.3264,  0.0659,  0.0131, -0.0196, -2.4990 ],
        [ 0.3750, -0.3121,  0.0662,  0.0147, -0.0221, -2.5472 ],
        [ 0.3955, -0.2791,  0.0652,  0.0134, -0.0217, -2.6468 ],
        [ 0.4301, -0.2283,  0.0644,  0.0126, -0.0254, -2.8177 ],
        [ 0.4597, -0.1879,  0.0640,  0.0121, -0.0264, -2.9629 ],
        [ 0.4724, -0.1678,  0.0637,  0.0116, -0.0288, -3.0282 ],
        [ 0.4876, -0.1471,  0.0641,  0.0097, -0.0279, -3.1131 ],
        [ -0.4835,  0.1142,  0.0589, -0.0073,  0.0276,  3.0614 ],
        [ -0.4781,  0.1027,  0.0590, -0.0060,  0.0266,  3.0232 ],
        [ -0.47220,  0.0877,  0.0589, -0.0025,  0.0250,  2.9725 ],
        [ -0.46545,  0.0736,  0.0599,  0.0011,  0.0262,  2.9144 ],
        [ -0.46029,  0.0670,  0.0598,  0.0020,  0.0172,  2.8724 ],
        [ -0.47313,  0.0089,  0.0604, -0.0007,  0.0160,  2.8340 ],
        [ -0.4805, -0.0449,  0.0614,  0.0029,  0.0159,  2.7771 ],
        [ -0.4803, -0.2023,  0.0623,  0.0027,  0.0151,  2.5508 ],
        [ -0.4542, -0.3165,  0.0627,  0.0044,  0.0146,  2.3007 ],
        [ -0.3950, -0.4124,  0.0649,  0.0125,  0.0163,  1.9809 ],
        [ -0.3588, -0.4431,  0.0658,  0.0168,  0.0162,  1.8182 ],
        [ -0.3013, -0.4752,  0.0676,  0.0186,  0.0154,  1.5855 ] ]
    ]
    mdepth_fill: False
    mdepth_fill_bg: True
    motion_mask_loss: False
    motion_mask_loss_all_area: False
    motion_mask_loss_weight: 0.002
    motion_mask_loss_exp: True
    #    znegfill: True
    static_on: True
    white_bkgd: False
    N_rand: 1024
    chunk: 8192
    #    val_chunk: 8192
    val_chunk: 16384
    netchunk: 131072
    
    
    
    
    num_frames: 39
    trim_start: 53
    dynamic_on: True
    use_viewdirs: True
    depth_loss_on: True
    depth_loss_lambda: 1.0
    depth_loss_all: False
    #    depth_loss_outside_mask: True
    depth_loss_miniter: 0
    depth_loss_func: 'l1'
    sparse_loss: True
    sparse_loss_weight: 0.00002
    sparse_loss_weighted: True
    sparse_loss_decay: -400
    align_pose_eval: True
    N_samples: 192
    volsdf:
      use_nerfplusplus: True
      obj_bounding_radius: 3.0
      W_geo_feat: 64
      surface_cfg:
        radius_init: 1.0 # ?
        embed_multires: -1
        W: 128
      radiance_cfg:
        W: 128
    override_poses_all_objs: [ True ]
    ignore_gripper: True
    eval_mask_gt_id: 4
datasets:
  train: ("kinectrobot_2022_0801_4_skip2_53to110_trainval_tf1",)
  test: "kinectrobot_2022_0801_4_skip2_53to110_trainval_tf4"
dataset:
  kinectrobot:
    gripper_mask_dilate: 7
    data_scale: 2.5
    clip_far: 2.75
    far: 3.0
    near: 0.0
    
    

    keep_frames: [ 57,58,59,60,64,65,66,67,68,69,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,102,103,104,105,106,107,108,109 ]
solver:

  batch_size: 39
  max_lr: 0.0005
  pose_lr: 0.001
  lrate_decay: 250000
  lrate_decay_pose: 250000
  num_epochs: 400

  bias_lr_factor: 1
  weight_decay: 0.0
  weight_decay_bias: 0.0
  save_every: True
  resume: True
  load_model: models/box/joint_stage1/model_epoch_049999.pth
  save_freq: 5
  find_unused_parameters: True
  #  detect_anomaly: True
  dist:
    sampler:
      shuffle: True
input:
  shuffle: False
test:
  do_visualization: True
  visualizer: pokingrecon
  evaluators: [ 'pokingrecon_mask_eval','pokingrecon_pose_eval','pokingrecon_mesh_eval' ]
  save_predictions: True

dataloader:
  collator: ExtendedBatchCollator
tf: 4